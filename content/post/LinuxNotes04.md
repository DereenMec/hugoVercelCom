---
title: "LinuxNotes.ç”¨æˆ·èº«ä»½ä¸æ–‡ä»¶æƒé™"
date: 2019-09-09T12:46:25+08:00
lastmod: 2019-09-09T12:46:25+08:00
draft: false
tags: [Linux]
categories: [Linux å­¦ä¹ ç¬”è®°]
author: "Dereen"
comment: true
toc: true
autoCollapseToc: false
---

## ç”¨æˆ·èº«ä»½ä¸èƒ½åŠ›

å¥½å¤šäººçš„æ½œæ„è¯†ä¸­ï¼ŒLinux ç³»ç»Ÿä¸­çš„ç®¡ç†å‘˜å°±æ˜¯rootã€‚è¿™å…¶å®æ˜¯é”™è¯¯çš„ï¼ŒLinux ç³»ç»Ÿçš„ç®¡ç†å‘˜ä¹‹æ‰€ä»¥æ˜¯rootï¼Œå¹¶ä¸æ˜¯å› ä¸ºå®ƒçš„åå­—å«rootï¼Œè€Œæ˜¯å› ä¸ºè¯¥ç”¨æˆ·çš„èº«ä»½å·ç å³UIDï¼ˆUser IDentificationï¼‰çš„æ•°å€¼ä¸º0ã€‚åœ¨Linux ç³»ç»Ÿä¸­ï¼ŒUIDå°±ç›¸å½“äºæ¯ä¸ªç”¨æˆ·çš„èº«ä»½è¯å·ç ï¼Œå®ƒå…·æœ‰å”¯ä¸€æ€§ï¼Œå› æ­¤å¯é€šè¿‡UIDå€¼æ¥åˆ¤æ–­ç”¨æˆ·èº«ä»½ã€‚åœ¨RHEL 7ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·èº«ä»½æœ‰ä¸‹é¢è¿™äº›ï¼š

- ç®¡ç†å‘˜UIDä¸º0ï¼šç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·
- ç³»ç»Ÿç”¨æˆ·UIDä¸º1~999ï¼šLinux ç³»ç»Ÿä¸ºäº†é¿å…æŸä¸ªæœåŠ¡ç¨‹åºå‡ºç°æ¼æ´è€Œè¢«é»‘å®¢ææƒè‡³æ•´å°æœåŠ¡å™¨ï¼Œé»˜è®¤æœåŠ¡ç¨‹åºä¼šæœ‰ç‹¬ç«‹çš„ç³»ç»Ÿç”¨æˆ·è´Ÿè´£è¿è¡Œï¼Œè¿›è€Œæœ‰æ•ˆæ§åˆ¶è¢«ç ´åèŒƒå›´
- æ™®é€šç”¨æˆ·UIDä»1000å¼€å§‹ï¼šæ˜¯ç”±ç®¡ç†å‘˜åˆ›å»ºçš„ç”¨äºæ—¥å¸¸å·¥ä½œçš„ç”¨æˆ·

ä¸ºäº†æ–¹ä¾¿ç®¡ç†å±äºåŒä¸€ç»„çš„ç”¨æˆ·ï¼ŒLinux ç³»ç»Ÿä¸­è¿˜å¼•å…¥äº†ç”¨æˆ·ç»„æ¦‚å¿µã€‚é€šè¿‡ä½¿ç”¨ç”¨æˆ·ç»„å·ç ï¼ˆGIDï¼ŒGroup IDentificationï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªç”¨æˆ·åŠ å…¥åŒä¸€ç»„ä¸­ï¼Œä»è€Œæ–¹ä¾¿ä¸ºç»„ä¸­çš„ç”¨æˆ·ç»Ÿä¸€è§„åˆ’æƒé™æˆ–æŒ‡å®šäººç‰©ã€‚

å¦å¤–ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­åˆ›å»ºæ¯ä¸ªç”¨æˆ·æ—¶ï¼Œå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸å…¶åŒåçš„åŸºæœ¬ç”¨æˆ·ç»„ï¼Œè€Œä¸”è¿™ä¸ªåŸºæœ¬ç”¨æˆ·ç»„åªæœ‰è¯¥ç”¨æˆ·ä¸€ä¸ªäººã€‚å¦‚æœè¯¥ç”¨æˆ·ä»¥åè¢«å½’çº³å…¥å…¶ä»–ç”¨æˆ·ç»„ï¼Œåˆ™è¿™ä¸ªå…¶ä»–ç”¨æˆ·ç»„ç§°ä¹‹ä¸ºæ‰©å±•ç”¨æˆ·ç»„ã€‚ä¸€ä¸ªç”¨æˆ·åªæœ‰ä¸€ä¸ªåŸºæœ¬ç”¨æˆ·ç»„ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªæ‰©å±•ç”¨æˆ·ç»„ï¼Œä»è€Œæ»¡è¶³æ—¥å¸¸çš„å·¥ä½œéœ€è¦ã€‚

### useradd ç”¨äºåˆ›å»ºæ–°çš„ç”¨æˆ·

useradd [é€‰é¡¹] ç”¨æˆ·å

ä½¿ç”¨ useradd å‘½ä»¤åˆ›å»ºç”¨æˆ·è´¦æˆ·ã€‚ä½¿ç”¨è¯¥å‘½ä»¤åˆ›å»ºç”¨æˆ·è´¦æˆ·æ—¶ï¼Œé»˜è®¤çš„ç”¨æˆ·å®¶ç›®å½•ä¼šè¢«å­˜æ”¾åœ¨/home ç›®å½•ä¸­ï¼Œé»˜è®¤çš„ Shell è§£é‡Šå™¨ä¸º/bin/bashï¼Œè€Œä¸”é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªä¸è¯¥ç”¨æˆ·åŒåçš„åŸºæœ¬ç”¨æˆ·ç»„ã€‚è¿™äº›é»˜è®¤è®¾ç½®å¯ä»¥æ ¹æ®ä¸‹è¡¨ä¸­çš„useradd å‘½ä»¤å‚æ•°è‡ªè¡Œä¿®æ”¹ã€‚

#### ç”¨æˆ·å‚æ•°åŠå…¶ä½œç”¨

| å‚æ•° | å«ä¹‰                                     |
| ---- | ---------------------------------------- |
| -d   | æŒ‡å®šç”¨æˆ·çš„å®¶ç›®å½•ï¼ˆé»˜è®¤ä¸º/home/usernameï¼‰ |
| -e   | è´¦æˆ·çš„åˆ°æœŸæ—¶é—´ï¼Œæ ¼å¼ä¸º YYYY-MM-DD.       |
| -u   | æŒ‡å®šè¯¥ç”¨æˆ·çš„é»˜è®¤ UID                     |
| -g   | æŒ‡å®šä¸€ä¸ªåˆå§‹çš„ç”¨æˆ·åŸºæœ¬ç»„ï¼ˆå¿…é¡»å·²å­˜åœ¨ï¼‰   |
| -G   | æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ‰©å±•ç”¨æˆ·ç»„                 |
| -N   | ä¸åˆ›å»ºä¸ç”¨æˆ·åŒåçš„åŸºæœ¬ç”¨æˆ·ç»„             |
| -s   | æŒ‡å®šè¯¥ç”¨æˆ·çš„é»˜è®¤ Shell è§£é‡Šå™¨            |

ä¸‹é¢æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·å¹¶æŒ‡å®šå®¶ç›®å½•è·¯å¾„ã€ç”¨æˆ·UIDä»¥åŠShell è§£é‡Šå™¨ã€‚ä¸‹é¢çš„å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†/sbin/nologin ä½œä¸ºç»ˆç«¯è§£é‡Šå™¨ï¼Œè¿™ä»£è¡¨ç€è¯¥ç”¨æˆ·ä¸èƒ½ç™»å½•åˆ°ç³»ç»Ÿä¸­ï¼š

```bash
[root@linuxprobe ~]## useradd -d /home/linux -u 8888 -s /sbin/nologin linuxprobe2
[root@linuxprobe ~]## id linuxprobe2
uid=8888(linuxprobe2) gid=8888(linuxprobe2) groups=8888(linuxprobe2)
```

### groupadd å‘½ä»¤ç”¨äºåˆ›å»ºç”¨æˆ·ç»„

groupadd [é€‰é¡¹] ç¾¤ç»„å

ä¸ºäº†æ›´é«˜æ•ˆåœ°æŒ‡æ´¾ç³»ç»Ÿä¸­å„ä¸ªç”¨æˆ·åœ°æƒé™ï¼Œåœ¨å·¥ä½œä¸­å¸¸å¸¸ä¼šæŠŠå‡ ä¸ªç”¨æˆ·åŠ å…¥åˆ°åŒä¸€ä¸ªç»„ï¼Œè¿™æ ·å¯ä»¥é’ˆå¯¹ä¸€ç±»ç”¨æˆ·ç»Ÿä¸€å®‰æ’æƒé™ã€‚

```bash
[root@linuxprobe ~]## groupadd shabi
```

### usermod å‘½ä»¤ç”¨äºä¿®æ”¹ç”¨æˆ·çš„å±æ€§

usermod [é€‰é¡¹] ç”¨æˆ·å

åœ¨Linux ç³»ç»Ÿä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶ï¼Œå› æ­¤åœ¨ç³»ç»Ÿä¸­åˆ›å»ºç”¨æˆ·ä¹Ÿå°±æ˜¯ä¿®æ”¹é…ç½®æ–‡ä»¶çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹/etc/passwd æ–‡ä»¶æ¥ä¿®æ”¹å…¶ä¸­çš„ç”¨æˆ·å‚æ•°ï¼Œä¹Ÿå¯ä½¿ç”¨usermod å‘½ä»¤ä¿®æ”¹å·²ç»åˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯ã€‚

#### å‘½ä»¤ä¸­çš„å‚æ•°åŠä½œç”¨

| å‚æ•°  | å«ä¹‰                                                         |      |
| ----- | ------------------------------------------------------------ | ---- |
| -c    | å¡«å†™ç”¨æˆ·è´¦æˆ·çš„å¤‡æ³¨ä¿¡æ¯                                       |      |
| -d -m | å‚æ•°-m ä¸å‚æ•°-d è¿ç”¨ï¼Œå¯é‡æ–°æŒ‡å®šç”¨æˆ·çš„å®¶ç›®å½•å¹¶è‡ªåŠ¨æŠŠæ—§çš„æ•°æ®è½¬ç§»è¿‡å» |      |
| -e    | è´¦æˆ·çš„åˆ°æœŸæ—¶é—´ï¼Œæ ¼å¼ä¸º YYYY-MM-DD                            |      |
| -g    | å˜æ›´æ‰€å±ç”¨æˆ·ç»„                                               |      |
| -G    | å˜æ›´æ‰©å±•ç”¨æˆ·ç»„                                               |      |
| -L    | é”å®šç”¨æˆ·ç¦æ­¢å…¶ç™»å½•ç³»ç»Ÿ                                       |      |
| -U    | è§£é”ç”¨æˆ·ï¼Œå…è®¸å…¶ç™»å½•ç³»ç»Ÿ                                     |      |
| -s    | å˜æ›´é»˜è®¤ç»ˆç«¯                                                 |      |
| -u    | ä¿®æ”¹ç”¨æˆ·çš„ UID                                               |      |

```bash
[root@linuxprobe ~]## id linuxprobe
uid=1000(linuxprobe) gid=1000(linuxprobe) groups=1000(linuxprobe),10(wheel)
## ä¿®æ”¹ç”¨æˆ·æ‰©å±•ç»„
[root@linuxprobe ~]## usermod -G root linuxprobe
[root@linuxprobe ~]## id linuxprobe
uid=1000(linuxprobe) gid=1000(linuxprobe) groups=1000(linuxprobe),0(root)
## åˆ é™¤ä¸Šä¸€èŠ‚ä¸­å»ºç«‹çš„Linuxprobe2ç”¨æˆ·
[root@linuxprobe ~]## userdel -r linuxprobe2
## ä¿®æ”¹ç”¨æˆ·UID
[root@linuxprobe ~]## usermod -u 8888 linuxprobe
[root@linuxprobe Desktop]## id linuxprobe
uid=8888(linuxprobe) gid=1000(linuxprobe) groups=1000(linuxprobe),0(root)
```

### passwd å‘½ä»¤ç”¨äºä¿®æ”¹ç”¨æˆ·å¯†ç ã€è¿‡æœŸæ—¶é—´ã€è®¤è¯ä¿¡æ¯ç­‰

passwd [é€‰é¡¹] ç”¨æˆ·å

æ™®é€šç”¨æˆ·åªèƒ½ä½¿ç”¨passwd å‘½ä»¤ä¿®æ”¹è‡ªèº«çš„ç³»ç»Ÿå¯†ç ï¼Œè€Œroot ç®¡ç†å‘˜åˆ™æœ‰æƒé™ä¿®æ”¹å…¶ä»–æ‰€æœ‰äººçš„å¯†ç ï¼Œè€Œä¸”ä¸éœ€è¦è¾“å…¥æ—§å¯†ç ã€‚

#### å‘½ä»¤ä¸­çš„å‚æ•°ä»¥åŠä½œç”¨

| å‚æ•°    | å«ä¹‰                                                         |
| ------- | ------------------------------------------------------------ |
| -l      | é”å®šç”¨æˆ·ï¼Œç¦æ­¢å…¶ç™»å½•                                         |
| -u      | è§£é™¤é”å®šï¼Œå…è®¸ç”¨æˆ·ç™»å½•                                       |
| --stdin | å…è®¸é€šè¿‡æ ‡å‡†è¾“å…¥ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œ å¦‚echo "NewPassWord" \| passwd --stdin  Username |
| -d      | ä½¿è¯¥ç”¨æˆ·å¯ç”¨ç©ºå¯†ç ç™»å½•ç³»ç»Ÿ                                   |
| -e      | å¼ºåˆ¶ç”¨æˆ·åœ¨ä¸‹æ¬¡ç™»å½•æ—¶ä¿®æ”¹å¯†ç                                  |
| -S      | æ˜¾ç¤ºç”¨æˆ·çš„å¯†ç æ˜¯å¦è¢«é”å®šï¼Œä»¥åŠå¯†ç æ‰€é‡‡ç”¨çš„åŠ å¯†ç®—æ³•åç§°       |

```bash
## ä½¿ç”¨ç®¡ç†å‘˜ä¿®æ”¹æ™®é€šç”¨æˆ·å¯†ç ï¼Œå½“æç¤ºå¯†ç ä¸è¶³8ä½åªéœ€å†è¾“å…¥ä¸€æ¬¡å³å¯
[root@linuxprobe Desktop]## passwd linuxprobe
Changing password for user linuxprobe.
New password: 
BAD PASSWORD: The password is shorter than 8 characters
Retype new password: 
passwd: all authentication tokens updated successfully.
## é”å®šlinuxprobe ç”¨æˆ·ï¼Œä¸å…è®¸å…¶ç™»å½•
[root@linuxprobe Desktop]## passwd -l linuxprobe 
Locking password for user linuxprobe.
passwd: Success
## æŸ¥çœ‹é”å®šçŠ¶æ€
[root@linuxprobe Desktop]## passwd -S linuxprobe 
linuxprobe LK 2020-03-29 0 99999 7 -1 (Password locked.)
## è§£é”
[root@linuxprobe Desktop]## passwd -u linuxprobe 
Unlocking password for user linuxprobe.
passwd: Success
[root@linuxprobe Desktop]## passwd -S linuxprobe 
linuxprobe PS 2020-03-29 0 99999 7 -1 (Password set, SHA512 crypt.)
```

### userdel å‘½ä»¤ç”¨äºåˆ é™¤ç”¨æˆ·

userdel [é€‰é¡¹] ç”¨æˆ·å

#### å‚æ•°åŠå…¶ä½œç”¨

| å‚æ•° | å«ä¹‰                     |
| ---- | ------------------------ |
| -f   | å¼ºåˆ¶åˆ é™¤ç”¨æˆ·             |
| -r   | åŒæ—¶åˆ é™¤ç”¨æˆ·åŠç”¨æˆ·å®¶ç›®å½• |

```bash
[root@linuxprobe Desktop]## userdel -r linuxprobe
```

## æ–‡ä»¶æƒé™ä¸å½’å±

å°½ç®¡åœ¨Linux ç³»ç»Ÿä¸­ä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶ï¼Œä½†æ˜¯æ¯ä¸ªæ–‡ä»¶çš„ç±»å‹ä¸å°½ç›¸åŒï¼Œå› æ­¤Linux ç³»ç»Ÿä½¿ç”¨äº†ä¸åŒçš„å­—ç¬¦æ¥åŠ ä»¥åŒºåˆ†ï¼Œå¸¸è§çš„å­—ç¬¦å¦‚ä¸‹æ‰€ç¤ºã€‚

- -ï¼šæ™®é€šæ–‡ä»¶
- dï¼šç›®å½•æ–‡ä»¶
- lï¼šé“¾æ¥æ–‡ä»¶
- bï¼šå—è®¾å¤‡æ–‡ä»¶
- cï¼šå­—ç¬¦è®¾å¤‡æ–‡ä»¶
- pï¼šç®¡é“æ–‡ä»¶

åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰æ‰€å±çš„æ‰€æœ‰è€…å’Œæ‰€æœ‰ç»„ï¼Œå¹¶ä¸”è§„å®šäº†æ–‡ä»¶çš„æ‰€æœ‰è€…ã€æ‰€æœ‰ç»„ä»¥åŠå…¶ä»–äººå¯¹æ–‡ä»¶æ‰€æ‹¥æœ‰çš„å¯è¯»ï¼ˆ rï¼‰ã€å¯å†™ï¼ˆ wï¼‰ã€å¯æ‰§è¡Œï¼ˆxï¼‰ç­‰æƒé™ã€‚å¯¹äº**ä¸€èˆ¬æ–‡ä»¶**æ¥è¯´ï¼Œâ€œå¯è¯»â€è¡¨ç¤ºèƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å®é™…å†…å®¹ï¼›â€œå¯å†™â€è¡¨ç¤ºèƒ½å¤Ÿç¼–è¾‘ã€æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶çš„å®é™…å†…å®¹ï¼› â€œå¯æ‰§è¡Œâ€åˆ™è¡¨ç¤ºèƒ½å¤Ÿè¿è¡Œä¸€ä¸ªè„šæœ¬ç¨‹åºã€‚

å¯¹**ç›®å½•æ–‡ä»¶**æ¥è¯´ï¼Œå¯è¯»â€è¡¨ç¤ºèƒ½å¤Ÿè¯»å–ç›®å½•å†…çš„æ–‡ä»¶åˆ—è¡¨ï¼›â€œå¯å†™â€è¡¨ç¤ºèƒ½å¤Ÿåœ¨ç›®å½•å†…æ–°å¢ã€åˆ é™¤ã€é‡å‘½åæ–‡ä»¶ï¼›è€Œâ€œå¯æ‰§è¡Œâ€åˆ™è¡¨ç¤ºèƒ½å¤Ÿè¿›å…¥è¯¥ç›®å½•ã€‚

![90b42cc9-ec61-4cfb-9ed3-ad8d9ccd631a.png](https://storage.live.com/items/55AB66419C029DA!4108?authkey=AFBtWHxjrNHYZLw)

æ–‡ä»¶æƒé™çš„**æ•°å­—æ³•åŸºäºå­—ç¬¦è¡¨ç¤ºï¼ˆrwxï¼‰çš„æƒé™è®¡ç®—è€Œæ¥**ï¼Œå…¶ç›®çš„æ˜¯ç®€åŒ–æƒé™çš„è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼ŒæŸä¸ªæ–‡ä»¶çš„æƒé™ä¸º777åˆ™ä»£è¡¨æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ·éƒ½ï¼šå¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚

![3490838c-7da5-4e3c-b48c-d9e237f1d2a7.png](https://storage.live.com/items/55AB66419C029DA!4109?authkey=AFBtWHxjrNHYZLw)

34298ä¸ºæ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œæœ€è¿‘ä¸€æ¬¡ä¿®æ”¹æ—¶é—´ä¸º4æœˆ2æ—¥å‡Œæ™¨23åˆ†ï¼Œæ–‡ä»¶åä¸ºinstall.logã€‚

## æ–‡ä»¶çš„ç‰¹æ®Šæƒé™

åœ¨å¤æ‚å¤šå˜çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå•çº¯è®¾ç½®æ–‡ä»¶çš„ rwx æƒé™æ— æ³•æ»¡è¶³æˆ‘ä»¬å¯¹å®‰å…¨å’Œçµæ´»æ€§çš„éœ€æ±‚ï¼Œå› æ­¤ä¾¿æœ‰äº† SUIDã€ SGID ä¸ SBIT çš„ç‰¹æ®Šæƒé™ä½ã€‚è¿™æ˜¯ä¸€ç§å¯¹æ–‡ä»¶æƒé™è¿›è¡Œè®¾ç½®çš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œå¯ä»¥ä¸ä¸€èˆ¬æƒé™åŒæ—¶ä½¿ç”¨ï¼Œä»¥å¼¥è¡¥ä¸€èˆ¬æƒé™ä¸èƒ½å®ç°çš„åŠŸèƒ½ã€‚

### SUID ï¼ˆé’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰

åœ¨Linux ä¸­ï¼Œæ‰€æœ‰è´¦å·çš„å¯†ç è®°å½•åœ¨/etc/shadow è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”åªæœ‰root å¯ä»¥è¯»å†™è¿™ä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯æ™®é€šç”¨æˆ·è¦æƒ³ä¿®æ”¹è‡ªå·±çš„å¯†ç æ€ä¹ˆåŠå‘¢ï¼Œè¿™å«è¦é€šè¿‡ç»™/bin/passwd è¿™ä¸ªæ–‡ä»¶èµ‹äºˆSUIDæƒé™ï¼Œç„¶åæ™®é€šç”¨æˆ·å°±å¯ä»¥åœ¨è°ƒç”¨passwd çš„è¿‡ç¨‹ä¸­å˜ä¸ºroot èº«ä»½ã€‚ä½†æ˜¯ï¼Œå¦‚æœè°ƒç”¨cat æŸ¥çœ‹/etc/shadow å†…å®¹åˆ™ä¸å¯ã€‚

![e978b6e2-c14e-4345-b797-1f5faf988707.png](https://storage.live.com/items/55AB66419C029DA!4110?authkey=AFBtWHxjrNHYZLw)

æ€»ç»“ï¼šSUIDæ˜¯ä¸€ç§é’ˆå¯¹**äºŒè¿›åˆ¶**ç¨‹åºè®¾ç½®çš„ç‰¹æ®Šæƒé™ï¼Œå¯ä»¥è®©äºŒè¿›åˆ¶ç¨‹åºçš„**æ‰§è¡Œè€…**åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­**ä¸´æ—¶æ‹¥æœ‰å±ä¸»çš„æƒé™**ï¼Œå½“ç„¶**å‰æä½ å¾—æœ‰æ‰§è¡Œæƒé™**ã€‚

### SGIDï¼ˆé’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶å’Œç›®å½•ï¼‰

SGIDä¸»è¦å®ç°ä¸‹é¢ä¸¤ç§åŠŸèƒ½ï¼š

- è®©æ‰§è¡Œè€…ä¸´æ—¶æ‹¥æœ‰å±ç»„çš„æƒé™ï¼ˆå¯¹æ‹¥æœ‰æ‰§è¡Œæƒé™çš„äºŒè¿›åˆ¶ç¨‹åºè¿›è¡Œè®¾ç½®ï¼‰
- åœ¨æŸä¸ªç›®å½•ä¸­åˆ›å»ºçš„æ–‡ä»¶è‡ªåŠ¨ç»§æ‰¿è¯¥ç›®å½•çš„ç”¨æˆ·ç»„ï¼ˆåªå¯ä»¥å¯¹ç›®å½•è¿›è¡Œè®¾ç½®ï¼‰

SGIDçš„ç¬¬ä¸€ç§åŠŸèƒ½ç±»ä¼¼äºSUIDï¼Œä¸åŒç‚¹åœ¨äºæ‰§è¡Œç¨‹åºçš„ç”¨æˆ·è·å–çš„ä¸å†æ˜¯æ–‡ä»¶æ‰€æœ‰è€…çš„ä¸´æ—¶æƒé™ï¼Œè€Œæ˜¯è·å–åˆ°æ–‡ä»¶æ‰€å±ç»„çš„æƒé™ã€‚

åœ¨Linux ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å…¶å½’å±çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œå½“åˆ›å»ºæˆ–ä¼ é€ä¸€ä¸ªæ–‡ä»¶åï¼Œè¿™ä¸ªæ–‡ä»¶å°±ä¼šè‡ªåŠ¨å½’å±äºæ‰§è¡Œè¿™ä¸ªæ“ä½œçš„ç”¨æˆ·ã€‚å¦‚æœç°åœ¨éœ€è¦åœ¨ä¸€ä¸ªéƒ¨é—¨å†…è®¾ç½®å…±äº«ç›®å½•ï¼Œè®©éƒ¨é—¨æ‰€æœ‰äººå‘˜éƒ½èƒ½å¤Ÿè¯»å–ç›®å½•ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ›å»ºéƒ¨é—¨å…±äº«ç›®å½•åï¼Œåœ¨è¯¥ç›®å½•ä¸Šè®¾ç½®SGID ç‰¹æ®Šæƒé™ä½ï¼Œè¿™æ ·éƒ¨é—¨å†…çš„ä»»ä½•äººå‘˜åœ¨é‡Œé¢åˆ›å»ºçš„ä»»ä½•æ–‡ä»¶éƒ½ä¼šå½’å±äºè¯¥ç›®å½•çš„æ‰€å±ç»„ï¼Œè€Œä¸å†æ˜¯è‡ªå·±çš„åŸºæœ¬ç”¨æˆ·ç»„ã€‚

```bash
[root@linuxprobe ~]## mkdir /public
[root@linuxprobe ~]## ls -ald /public/
drwxr-xr-x. 2 root root 6 Mar 29 12:08 /public/
[root@linuxprobe ~]## chmod -Rf 777 /public/
[root@linuxprobe ~]## chmod -Rf g+s /public/
[root@linuxprobe ~]## ls -ald /public/
drwxrwsrwx. 2 root root 6 Mar 29 12:08 /public/
[root@linuxprobe ~]## su - linuxprobe
[linuxprobe@linuxprobe ~]$ cd /public/
[linuxprobe@linuxprobe public]$ touch test.md
[linuxprobe@linuxprobe public]$ ls -ld test.md 
-rw-rw-r--. 1 linuxprobe root 0 Mar 29 12:13 test.md
```

### SBITï¼ˆé’ˆå¯¹ç›®å½•ï¼‰

ç°åœ¨ï¼Œå¤§å­¦é‡Œå¾ˆå¤šè€å¸ˆéƒ½è¦æ±‚å­¦ç”Ÿå°†ä½œä¸šä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ç‰¹å®šå…±äº«ç›®å½•ä¸­ï¼Œä½†æ€»æ˜¯æœ‰â€œç ´ååˆ†å­â€å–œæ¬¢åˆ é™¤å…¶ä»–åŒå­¦çš„ä½œä¸šï¼Œè¿™æ—¶å°±è¦è®¾ç½®SBITï¼ˆSticky Bitï¼‰ç‰¹æ®Šæƒé™ä½äº†ã€‚SBITç‰¹æ®Šæƒé™ä½å¯ç¡®ä¿ç”¨æˆ·åªèƒ½åˆ é™¤è‡ªå·±æ‰€å±çš„æ–‡ä»¶ï¼Œä¸èƒ½åˆ é™¤å…¶ä»–ç”¨æˆ·çš„æ–‡ä»¶ã€‚

```bash
[root@linuxprobe ~]## chmod -Rf 1777 /public/
[root@linuxprobe ~]## vi /public/test.md
Can not be deleted by others.
[root@linuxprobe ~]## su - linuxprobe 
Last login: Sun Mar 29 17:08:15 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ rm -rf /public/test.md 
rm: cannot remove â€˜/public/test.mdâ€™: Operation not permitted
[linuxprobe@linuxprobe ~]$ ls -ld /public/
drwxrwsrwt. 2 root root 20 Mar 29 17:14 /public/
```

### chmod å’Œchown

chmod å‘½ä»¤ç”¨æ¥è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ï¼Œæ ¼å¼ä¸ºâ€œchmod [å‚æ•°] æƒé™ æ–‡ä»¶æˆ–ç›®å½•åç§°â€ã€‚å…¶ä¸­å¸¸ç”¨çš„å‚æ•°æœ‰ï¼š

- Rï¼šé€’å½’çš„å°†è¯¥æ–‡ä»¶å¤¹å’Œå­æ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶è®¾ç½®ä¸ºåŒæ ·çš„æƒé™
- fï¼šé™é»˜æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºå¤§å¤šæ•°çš„é”™è¯¯

é™¤äº†è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™å¤–ï¼Œè¿˜å¯ä»¥è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ï¼Œè¿™é‡Œä½¿ç”¨çš„å‘½ä»¤ä¸º chownï¼Œå…¶æ ¼å¼ä¸ºâ€œchown [å‚æ•°] æ‰€æœ‰è€…:æ‰€å±ç»„ æ–‡ä»¶æˆ–ç›®å½•åç§°â€ã€‚

é€šè¿‡åœ¨å¸¸è§„æƒé™å‰å†åŠ æ•°å­—æ¥è®¾ç½®ç‰¹æ®Šæƒé™ï¼Œ4ä¸ºSUIDï¼Œ2ä¸ºSGIDï¼Œ1ä¸ºSBITã€‚

ä¹Ÿå¯ä»¥é€šè¿‡è‹±æ–‡è®¾ç½®ï¼š

```
chmod u+s testfile ## ä¸º testfile æ–‡ä»¶åŠ ä¸Š SUID æƒé™ã€‚
chmod g+s testdir  ## ä¸º testdir ç›®å½•åŠ ä¸Š SGID æƒé™ã€‚
chmod o+t testdir  ## ä¸º testdir ç›®å½•åŠ ä¸Š SBIT æƒé™ã€‚
```

## æ–‡ä»¶çš„éšè—å±æ€§

Linux ç³»ç»Ÿä¸­çš„æ–‡ä»¶é™¤äº†å…·å¤‡ä¸€èˆ¬æƒé™å’Œç‰¹æ®Šæƒé™ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§éšè—æƒé™ï¼Œå³è¢«éšè—èµ·æ¥çš„æƒé™ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ç›´æ¥è¢«ç”¨æˆ·å‘è§‰ã€‚

### chattr å‘½ä»¤ç”¨äºè®¾ç½®æ–‡ä»¶çš„éšè—æƒé™

chattr [å‚æ•°] æ–‡ä»¶ã€‚å¦‚æœæƒ³è¦æŠŠæŸä¸ªéšè—åŠŸèƒ½æ·»åŠ åˆ°æ–‡ä»¶ä¸Šï¼Œåˆ™éœ€è¦åœ¨å‘½ä»¤åé¢è¿½åŠ â€œ+å‚æ•°â€ï¼Œå¦‚æœæƒ³è¦æŠŠæŸä¸ªéšè—åŠŸèƒ½ç§»å‡ºæ–‡ä»¶ï¼Œåˆ™éœ€è¦è¿½åŠ â€œ-å‚æ•°â€ã€‚

#### å‚æ•°åŠå…¶ä½œç”¨

| å‚æ•° | å«ä¹‰                                                         |      |
| ---- | ------------------------------------------------------------ | ---- |
| i    | æ— æ³•å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼›è‹¥å¯¹ç›®å½•è®¾ç½®äº†è¯¥å‚æ•°ï¼Œåˆ™ä»…èƒ½ä¿®æ”¹å…¶ä¸­çš„å­æ–‡ä»¶å†…å®¹è€Œä¸èƒ½æ–°å»ºæˆ–åˆ é™¤æ–‡ä»¶ |      |
| a    | ä»…å…è®¸è¡¥å……ï¼ˆè¿½åŠ ï¼‰å†…å®¹ï¼Œæ— æ³•è¦†ç›–/åˆ é™¤å†…å®¹ï¼ˆ Append Onlyï¼‰    |      |
| S    | æ–‡ä»¶å†…å®¹åœ¨å˜æ›´åç«‹å³åŒæ­¥åˆ°ç¡¬ç›˜ï¼ˆ syncï¼‰                      |      |
| s    | å½»åº•ä»ç¡¬ç›˜ä¸­åˆ é™¤ï¼Œä¸å¯æ¢å¤ï¼ˆç”¨ 0 å¡«å……åŸæ–‡ä»¶æ‰€åœ¨ç¡¬ç›˜åŒºåŸŸï¼‰    |      |
| A    | ä¸å†ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æœ€åè®¿é—®æ—¶é—´ï¼ˆ atimeï¼‰               |      |
| b    | ä¸å†ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„å­˜å–æ—¶é—´                                 |      |
| D    | æ£€æŸ¥å‹ç¼©æ–‡ä»¶ä¸­çš„é”™è¯¯                                         |      |
| d    | ä½¿ç”¨ dump å‘½ä»¤å¤‡ä»½æ—¶å¿½ç•¥æœ¬æ–‡ä»¶/ç›®å½•                          |      |
| c    | é»˜è®¤å°†æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œå‹ç¼©                                     |      |
| u    | å½“åˆ é™¤è¯¥æ–‡ä»¶åä¾ç„¶ä¿ç•™å…¶åœ¨ç¡¬ç›˜ä¸­çš„æ•°æ®ï¼Œæ–¹ä¾¿æ—¥åæ¢å¤         |      |
| t    | è®©æ–‡ä»¶ç³»ç»Ÿæ”¯æŒå°¾éƒ¨åˆå¹¶ï¼ˆ tail-mergingï¼‰                      |      |
| X    | å¯ä»¥ç›´æ¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹                                 |      |

```bash
[root@linuxprobe ~]## echo "For test" > linuxprobe
[root@linuxprobe ~]## rm linuxprobe
rm: remove regular file â€˜linuxprobeâ€™? y
[root@linuxprobe ~]## echo "For test" > linuxprobe
[root@linuxprobe ~]## chattr +a linuxprobe 
[root@linuxprobe ~]## rm linuxprobe 
rm: remove regular file â€˜linuxprobeâ€™? y
rm: cannot remove â€˜linuxprobeâ€™: Operation not permitted
```

### lsattr å‘½ä»¤ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„éšè—æƒé™

lsattr [å‚æ•°] æ–‡ä»¶ã€‚éšè—æƒé™ä½¿ç”¨æ™®é€šçš„ls å‘½ä»¤æ˜¯çœ‹ä¸è§çš„ï¼Œåªèƒ½ä½¿ç”¨lsattr å‘½ä»¤æŸ¥çœ‹éšè—æƒé™ã€‚

```bash
[root@linuxprobe ~]## ls -la linuxprobe 
-rw-r--r--. 1 root root 9 Mar 29 17:33 linuxprobe
[root@linuxprobe ~]## lsattr linuxprobe 
-----a---------- linuxprobe
[root@linuxprobe ~]## chattr -a linuxprobe 
[root@linuxprobe ~]## lsattr linuxprobe 
---------------- linuxprobe
[root@linuxprobe ~]## rm linuxprobe 
rm: remove regular file â€˜linuxprobeâ€™? y
```

## æ–‡ä»¶è®¿é—®æ§åˆ¶åˆ—è¡¨

æˆ‘ä»¬ä¹‹å‰æ¥è§¦åˆ°çš„ä¸€èˆ¬æƒé™ã€ç‰¹æ®Šæƒé™ã€éšè—æƒé™æœ‰ä¸€ä¸ªå…±æ€§â€”â€”æƒé™æ˜¯é’ˆå¯¹æŸä¸€ç±»ç”¨æˆ·è®¾ç½®çš„ã€‚å¦‚æœå¸Œæœ›å¯¹æŸä¸ªæŒ‡å®šçš„ç”¨æˆ·è¿›è¡Œå•ç‹¬çš„æƒé™æ§åˆ¶ï¼Œå°±éœ€è¦ç”¨åˆ°æ–‡ä»¶çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰äº†ã€‚é€šä¿—æ¥è®²ï¼ŒåŸºäºæ™®é€šæ–‡ä»¶æˆ–ç›®å½•è®¾ç½®ACL å…¶å®å°±æ˜¯é’ˆå¯¹æŒ‡å®šçš„ç”¨æˆ·æˆ–ç”¨æˆ·ç»„è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æ“ä½œæƒé™ã€‚å¦å¤–ï¼Œ**å¦‚æœé’ˆå¯¹æŸä¸ªç›®å½•è®¾ç½®äº†ACLï¼Œåˆ™ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šç»§æ‰¿å…¶ACLï¼›è‹¥é’ˆå¯¹æ–‡ä»¶è®¾ç½®äº†ACLï¼Œåˆ™æ–‡ä»¶ä¸å†ç»§æ‰¿å…¶æ‰€åœ¨ç›®å½•çš„ACLã€‚**

```bash
[root@linuxprobe ~]## su - linuxprobe 
Last login: Sun Mar 29 17:14:55 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ cd /root
-bash: cd: /root: Permission denied
[linuxprobe@linuxprobe ~]$ exit
logout
```

å¦‚ä¸Šæ‰€ç¤ºï¼Œæ™®é€šç”¨æˆ·æ˜¯æ— æ³•è¿›å…¥rootç®¡ç†å‘˜çš„å®¶ç›®å½•çš„ã€‚

### setfacl å‘½ä»¤ç”¨äºç®¡ç†æ–‡ä»¶çš„ACLè§„åˆ™

setfacl [å‚æ•°] æ–‡ä»¶å

æ–‡ä»¶çš„ACLæä¾›çš„æ˜¯åœ¨æ‰€æœ‰è€…ã€æ‰€å±ç»„ã€å…¶ä»–äººçš„è¯»/å†™/æ‰§è¡Œæƒé™ä¹‹å¤–çš„ç‰¹æ®Šæƒé™æ§åˆ¶ï¼Œä½¿ç”¨setfacl å‘½ä»¤å¯ä»¥é’ˆå¯¹å•ä¸€ç”¨æˆ·æˆ–ç”¨æˆ·ç»„ã€å•ä¸€æ–‡ä»¶æˆ–ç›®å½•æ¥è¿›è¡Œè¯»/å†™/æ‰§è¡Œæƒé™çš„æ§åˆ¶ã€‚å…¶ä¸­ï¼Œé’ˆå¯¹ç›®å½•æ–‡ä»¶éœ€è¦ä½¿ç”¨-R é€’å½’å‚æ•°ï¼›é’ˆå¯¹æ™®é€šæ–‡ä»¶åˆ™ä½¿ç”¨-m å‚æ•°ï¼›å¦‚æœè¦åˆ é™¤æŸä¸ªæ–‡ä»¶çš„ACLï¼Œåˆ™å¯ä»¥ä½¿ç”¨-b å‚æ•°ã€‚ä¸‹é¢çš„ä¾‹å­è®¾ç½®ç”¨æˆ·linuxprobe åœ¨/root ç›®å½•ä¸Šçš„æƒé™ï¼š

```bash
[root@linuxprobe ~]## setfacl -Rm u:linuxprobe:rwx /root
[root@linuxprobe ~]## su - linuxprobe 
Last login: Sun Mar 29 17:42:15 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ cd /root
[linuxprobe@linuxprobe root]$ ls
CheckHosts.sh  delusers.sh  Downloads     ipaddrs.txt  Pictures   users.txt
chkhost.sh     Desktop      example.sh    mkcdrom.sh   Public     Videos
clsscore.sh    Documents    gussprice.sh  Music        Templates
[linuxprobe@linuxprobe root]$ cat users.txt
zhangsan
lisi
wangwu
zhaoliu
wuqi
zhuba
[linuxprobe@linuxprobe root]$ exit
logout
```

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•çŸ¥é“æ–‡ä»¶ä¸Šæœ‰å“ªäº›ACLå‘¢ï¼Ÿå¸¸ç”¨çš„ls å‘½ä»¤è™½ç„¶çœ‹ä¸åˆ°ACL è¡¨ä¿¡æ¯ï¼Œä½†æ˜¯å´å¯ä»¥çœ‹åˆ°æ–‡ä»¶çš„æƒé™æœ€åä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰å˜æˆäº†åŠ å·ï¼ˆ+ï¼‰ï¼Œè¿™å°±æ„å‘³ç€è¯¥æ–‡ä»¶å·²ç»è®¾ç½®äº†ACLäº†ã€‚

```bash
[root@linuxprobe ~]## ls -dl /root/
dr-xrwx---+ 14 root root 4096 Mar 29 17:36 /root/
```

### getfacl å‘½ä»¤ç”¨äºæ˜¾ç¤ºæ–‡ä»¶ä¸Šè®¾ç½®çš„ACLä¿¡æ¯

getfacl æ–‡ä»¶åç§°

```bash
[root@linuxprobe ~]## getfacl /root
getfacl: Removing leading '/' from absolute path names
## file: root
## owner: root
## group: root
user::r-x
**user:linuxprobe:rwx**
group::r-x
mask::rwx
other::---
```

## su å‘½ä»¤ä¸sudo æœåŠ¡

åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åƒåœ¨å­¦ä¹ æ—¶ä¸€ç›´ä½¿ç”¨root ç®¡ç†å‘˜è´¦æˆ·ï¼Œè¿™æ ·åŠ å¤§äº†æ“ä½œå¤±è¯¯å¯¼è‡´ç³»ç»Ÿå´©æºƒçš„å¯èƒ½æ€§ã€‚

su å‘½ä»¤å¯ä»¥è§£å†³åˆ‡æ¢ç”¨æˆ·èº«ä»½çš„éœ€æ±‚ï¼Œä½¿å¾—å½“å‰ç”¨æˆ·åœ¨ä¸é€€å‡ºç™»å½•çš„æƒ…å†µä¸‹ï¼Œé¡ºç•…åœ°åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·ï¼Œæ¯”å¦‚ä»root ç®¡ç†å‘˜åˆ‡æ¢è‡³æ™®é€šç”¨æˆ·ã€‚ä½¿ç”¨`su - ç”¨æˆ·å`æ¥åˆ‡æ¢ï¼Œå…¶ä¸­çš„å‡å·ï¼ˆ-ï¼‰æ„å‘³ç€åˆ‡æ¢ç”¨æˆ·çš„åŒæ—¶ï¼ŒæŠŠç¯å¢ƒå˜é‡é¡µå˜æ›´ä¸ºæ–°ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œä¸æ˜¯åŒ…ç•™åŸå§‹çš„ä¿¡æ¯ã€‚

ğŸ’¡å°½ç®¡åƒè¿™æ ·ä½¿ç”¨su å‘½ä»¤åï¼Œæ™®é€šç”¨æˆ·å¯ä»¥å®Œå…¨åˆ‡æ¢åˆ°root ç®¡ç†å‘˜èº«ä»½æ¥å®Œæˆç›¸åº”å·¥ä½œï¼Œä½†è¿™å¢å¤§äº†æš´éœ²root ç®¡ç†å‘˜å¯†ç çš„å¯èƒ½æ€§ã€‚

å–è€Œä»£ä¹‹çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sudo å‘½ä»¤æŠŠç‰¹å®šå‘½ä»¤çš„æ‰§è¡Œæƒé™èµ‹äºˆç»™æŒ‡å®šç”¨æˆ·ï¼Œè¿™æ ·æ—¢å¯ä¿è¯æ™®é€šç”¨æˆ·èƒ½å®Œæˆç‰¹å®šå·¥ä½œï¼Œä¹Ÿå¯ä»¥é¿å…æ³„éœ²root ç®¡ç†å‘˜å¯†ç ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆç†é…ç½®sudo æœåŠ¡ï¼Œä»¥è¾¹å…¼é¡¾ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç”¨æˆ·çš„ä¾¿æ·æ€§ã€‚sudo æœåŠ¡çš„é…ç½®åŸåˆ™ä¹Ÿå¾ˆç®€å•â€”â€”**åœ¨ä¿è¯æ™®é€šç”¨æˆ·å®Œæˆç›¸åº”å·¥ä½œçš„å‰æä¸‹ï¼Œå°½å¯èƒ½å°‘åœ°èµ‹äºˆé¢å¤–çš„æƒé™ã€‚**

sudo å‘½ä»¤ç”¨äºç»™æ™®é€šç”¨æˆ·æä¾›é¢å¤–çš„æƒé™æ¥å®ŒæˆåŸæœ¬root ç®¡ç†å‘˜æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œæ ¼å¼ä¸ºâ€œsudo [å‚æ•°] å‘½ä»¤åç§°â€ã€‚sudo æœåŠ¡ä¸­å¯ç”¨çš„å‚æ•°ä»¥åŠç›¸åº”çš„ä½œç”¨å¦‚è¡¨æ‰€ç¤ºã€‚

| å‚æ•°             | å«ä¹‰                                                     |
| ---------------- | -------------------------------------------------------- |
| -h               | åˆ—å‡ºå¸®åŠ©ä¿¡æ¯                                             |
| -l               | åˆ—å‡ºå½“å‰ç”¨æˆ·å¯æ‰§è¡Œçš„å‘½ä»¤                                 |
| -u ç”¨æˆ·åæˆ–UIDå€¼ | ä»¥æŒ‡å®šçš„ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤                                 |
| -k               | æ¸…ç©ºå¯†ç çš„æœ‰æ•ˆæ—¶é—´ï¼Œä¸‹æ¬¡æ‰§è¡Œ sudo æ—¶éœ€è¦å†æ¬¡è¿›è¡Œå¯†ç éªŒè¯ |
| -b               | åœ¨åå°æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤                                     |
| -p               | æ›´æ”¹è¯¢é—®å¯†ç çš„æç¤ºè¯­                                     |

æ€»çš„æ¥è¯´ï¼Œsudo å‘½ä»¤å…·æœ‰å¦‚ä¸‹åŠŸèƒ½ï¼š

- é™åˆ¶ç”¨æˆ·æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤
- è®°å½•ç”¨æˆ·æ‰§è¡Œçš„æ¯ä¸€æ¡å‘½ä»¤
- é…ç½®æ–‡ä»¶ï¼ˆ/etc/sudoersï¼‰æä¾›é›†ä¸­çš„ç”¨æˆ·ç®¡ç†ã€æƒé™ä¸ä¸»æœºç­‰å‚æ•°
- éªŒè¯å¯†ç åçš„5åˆ†é’Ÿå†…ï¼ˆé»˜è®¤å€¼ï¼‰æ— éœ€å†è®©ç”¨æˆ·éªŒè¯å¯†ç 

å¦‚æœæ‹…å¿ƒç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶ä¼šå‡ºç°é—®é¢˜ï¼Œåˆ™å¯ä»¥ä½¿ç”¨sufo å‘½ä»¤æä¾›çš„visudo å‘½ä»¤æ¥é…ç½®ç”¨æˆ·æƒé™ã€‚è¿™æ¡å‘½ä»¤åœ¨é…ç½®ç”¨æˆ·æƒé™æ—¶å°†ç¦æ­¢å¤šä¸ªç”¨æˆ·åŒæ—¶ä¿®æ”¹sudoers é…ç½®æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å¯¹é…ç½®æ–‡ä»¶å†…çš„å‚æ•°è¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œå¹¶åœ¨å‘ç°å‚æ•°é”™è¯¯æ—¶è¿›è¡ŒæŠ¥é”™ã€‚

ğŸ’¡åªæœ‰root ç®¡ç†å‘˜æ‰å¯ä»¥ä½¿ç”¨visudo å‘½ä»¤ç¼–è¾‘sudo æœåŠ¡çš„é…ç½®æ–‡ä»¶

```bash
[root@linuxprobe Desktop]## visudo
96 ##
97 ### Allow root to run any commands anywhere
98 root ALL=(ALL) ALL
99 linuxprobe ALL=(ALL) ALL
[root@linuxprobe Desktop]## su - linuxprobe 
Last login: Sun Mar 29 17:56:33 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ sudo -l
[sudo] password for linuxprobe: 
Matching Defaults entries for linuxprobe on this host:
    requiretty, !visiblepw, always_set_home, env_reset, env_keep="COLORS
    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS", env_keep+="MAIL PS1
    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE", env_keep+="LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES", env_keep+="LC_MONETARY
    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE", env_keep+="LC_TIME LC_ALL
    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY",
    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin

User linuxprobe may run the following commands on this host:
    (ALL) ALL
[linuxprobe@linuxprobe ~]$ sudo ls /root
CheckHosts.sh  delusers.sh  Downloads	  ipaddrs.txt  Pictures   users.txt
chkhost.sh     Desktop	    example.sh	  mkcdrom.sh   Public	  Videos
clsscore.sh    Documents    gussprice.sh  Music        Templates
```

**è€ƒè™‘åˆ°ç”Ÿæˆç¯å¢ƒä¸­ä¸å…è®¸æŸä¸ªæ™®é€šç”¨æˆ·æ‹¥æœ‰æ•´ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰çš„å‘½ä»¤çš„æœ€é«˜æ‰§è¡Œæƒï¼Œå› æ­¤ALLå‚æ•°å°±æœ‰äº›ä¸åˆé€‚äº†ã€‚å› æ­¤åªèƒ½èµ‹äºˆæ™®é€šç”¨æˆ·å…·ä½“çš„å‘½ä»¤ä»¥æ»¡è¶³å·¥ä½œéœ€æ±‚ï¼Œè¿™ä¹Ÿå—åˆ°äº†å¿…è¦çš„æƒé™çº¦æŸã€‚å¦‚æœéœ€è¦è®©æŸä¸ªç”¨æˆ·åªèƒ½ä½¿ç”¨root ç®¡ç†å‘˜çš„èº«ä»½æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œåˆ‡è®°ä¸€å®šè¦ç»™å‡ºè¯¥å‘½ä»¤çš„ç»å¯¹è·¯å¾„ï¼Œå¦åˆ™ç³»ç»Ÿä¼šè¯†åˆ«ä¸å‡ºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨whereis å‘½ä»¤æ¥æ‰¾å‡ºå‘½ä»¤æ‰€å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ã€‚**

```bash
[linuxprobe@linuxprobe ~]$ exit
logout
[root@linuxprobe Desktop]## whereis cat
cat: **/usr/bin/cat** /usr/share/man/man1/cat.1.gz /usr/share/man/man1p/cat.1p.gz
[root@linuxprobe Desktop]## visudo
96 ##
97 ### Allow root to run any commands anywhere
98 root ALL=(ALL) ALL
**99 linuxprobe ALL=(ALL) /usr/bin/cat**
[root@linuxprobe Desktop]## su - linuxprobe 
Last login: Mon Mar 30 19:48:49 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ cat /etc/shadow
cat: /etc/shadow: Permission denied
[linuxprobe@linuxprobe ~]$ sudo cat /etc/shadow
[sudo] password for linuxprobe: 
root:$6$qPovRFFl$ZXpVbuZDRay7zsc5mjFneiyKRkoxfo7Z8uT05cEadU7EWIiw3I22xZOMdxn5M6KpEJFLKpI2AWXqYksy97cK2.:18348:0:99999:7:::
bin:*:16141:0:99999:7:::
daemon:*:16141:0:99999:7:::
adm:*:16141:0:99999:7:::
lp:*:16141:0:99999:7:::
sync:*:16141:0:99999:7:::
shutdown:*:16141:0:99999:7:::
ã€‚ã€‚ã€‚çœç•¥ã€‚ã€‚ã€‚
```

å¦‚æœè§‰å¾—æ¯æ¬¡è¿›è¡Œsudo æ“ä½œéƒ½è¦è¾“å¯†ç å¾ˆéº»çƒ¦ï¼Œå¯ä»¥ä¸ºlinuxprobe ç”¨æˆ·æ·»åŠ NOPASSWD å‚æ•°ã€‚

```bash
[linuxprobe@linuxprobe ~]$ exit
logout
[root@linuxprobe Desktop]## visudo
96 ##
97 ### Allow root to run any commands anywhere
98 root ALL=(ALL) ALL
99 linuxprobe ALL=NOPASSWD: /usr/sbin/poweroff
[root@linuxprobe Desktop]## su - linuxprobe 
Last login: Mon Mar 30 19:55:06 CST 2020 on pts/0
[linuxprobe@linuxprobe ~]$ sudo cat /etc/shadow
root:$6$qPovRFFl$ZXpVbuZDRay7zsc5mjFneiyKRkoxfo7Z8uT05cEadU7EWIiw3I22xZOMdxn5M6KpEJFLKpI2AWXqYksy97cK2.:18348:0:99999:7:::
bin:*:16141:0:99999:7:::
daemon:*:16141:0:99999:7:::
adm:*:16141:0:99999:7:::
lp:*:16141:0:99999:7:::
ã€‚ã€‚ã€‚çœç•¥ã€‚ã€‚ã€‚
```

è¿™æ—¶å°±ä¸ç”¨è¾“å…¥å¯†ç äº†ğŸ˜Šã€‚