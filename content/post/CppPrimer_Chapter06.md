---
title: "CppPrimer06.函数"
date: 2020-04-25T11:20:09+08:00
lastmod: 2020-04-25T11:20:09+08:00
draft: true
tags: [C++, 学习笔记]
categories: [C++ Primer 学习笔记]
author: "Dereen"
comment: true
toc: true
autoCollapseToc: false
---



<!--more-->

## 函数基础

一个典型的函数定义包含以下部分：返回类型、函数名字、由0个或多个形参组成的列表及函数体。

### 局部对象

在C++语言中，名字有作用域，对象有生命周期。形参和在函数体内部定义的变量统称为局部变量。

#### 自动对象

对于普通局部变量对应的对象来说，当函数的控制路径经过变量定义语句时创建该对象，当到达定义所在的块末尾时销毁它。这种只存在于块执行期间的对象称为自动对象，形参是一种自动对象。

#### 局部静态对象

某些时候，有必要令局部变量的生命周期贯穿函数调用及之后的时间。可以将局部变量定义成static类型从而获得这样的对象。**局部静态对象在程序的执行路径第一次经过对象定义语句时初始化，并知道程序终止才被销毁。**

```cpp
size_t count_calls(){
    static size_t cnt = 0;
    return ++cnt;
}

int main() {
    for (int i = 0; i <= 10; ++i){
        count_calls();
    }
    cout << count_calls() << endl;           // 输出12
}
```

### 函数声明

💡建议在头文件中进行函数声明，而在源文件中进行函数的定义，源文件应该包含头文件。

### 分离式编译

大多数编译器提供了分离式编译每个文件的机制，这一过程通常会产生一个后缀名是`.obj`（Windows）或`.o`（Unix）的文件，后缀名的含义是该文件包含对象代码。

## 参数传递

当形参是引用类型时，我们说它对应的实参被**引用传递**或者**函数被传引用调用**。当实参的值被拷贝给形参时，形参和实参是两个相互独立的对象。我们说这样的实参是被**值传递**或者**函数被传值调用**。

### 传值参数

- 在C++语言中，建议使用引用类型的形参代替指针；
- 如果函数无需改变引用形参的值，最好将其声明为常量引用；

```cpp
void func(int &a){/*...*/}     // 引用传递
void func(int a){/*...*/}      // 值传递
```

### const形参和实参

在形参初始化的时候，顶层const会被忽略：

```cpp
int func(int val){
    return ++val;
}

int main() {
    const int i = 20;
    cout << func(i) << endl;       // 输出21
}
```

💡尽量使用常量引用。

### 数组形参

